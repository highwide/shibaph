box: wercker/rvm
build:
  steps:
    - rvm-use:
        version: 2.2.0
    - bundle-install
    - rails-database-yml
    - script:
        name: echo ruby information
        code: |
            echo "ruby version $(ruby --version) running"
            echo "from location $(which ruby)"
            echo -p "gem list: $(gem list)"
    - script:
        name: Set up db
        code: bundle exec rake db:schema:load
    - script:
        name: Set up assets
        code: bundle exec rake assets:precompile
    - script:
        name: rake spec
        code: bundle exec rake test
  after-steps:
    - slack-notifier:
        url: $SLACK_URL
        channel: notification
        username: wercker
